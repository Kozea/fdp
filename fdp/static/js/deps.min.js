/*! fdp          2015-09-17 */
!function(a,b){var c,d,e;return e="shapeshift",d={selector:"*",enableDrag:!0,enableCrossDrop:!0,enableResize:!0,enableTrash:!1,align:"center",colWidth:null,columns:null,minColumns:1,autoHeight:!0,maxHeight:null,minHeight:100,gutterX:10,gutterY:10,paddingX:10,paddingY:10,animated:!0,animateOnInit:!1,animationSpeed:225,animationThreshold:100,dragClone:!1,deleteClone:!0,dragRate:100,dragWhitelist:"*",crossDropWhitelist:"*",cutoffStart:null,cutoffEnd:null,handle:!1,cloneClass:"ss-cloned-child",activeClass:"ss-active-child",draggedClass:"ss-dragged-child",placeholderClass:"ss-placeholder-child",originalContainerClass:"ss-original-container",currentContainerClass:"ss-current-container",previousContainerClass:"ss-previous-container"},c=function(){function c(b,c){this.element=b,this.options=a.extend({},d,c),this.globals={},this.$container=a(b),this.errorCheck()&&this.init()}return c.prototype.errorCheck=function(){var a,b,c,d;return d=this.options,c=!1,b="Shapeshift ERROR:",null===d.colWidth&&(a=this.$container.children(d.selector),0===a.length&&(c=!0,console.error(""+b+" option colWidth must be specified if Shapeshift is initialized with no active children."))),!c},c.prototype.init=function(){return this.createEvents(),this.setGlobals(),this.setIdentifier(),this.setActiveChildren(),this.enableFeatures(),this.gridInit(),this.render(),this.afterInit()},c.prototype.createEvents=function(){var a,b;return b=this.options,a=this.$container,a.off("ss-arrange").on("ss-arrange",function(a){return function(b,c){return null==c&&(c=!1),a.render(!1,c)}}(this)),a.off("ss-rearrange").on("ss-rearrange",function(a){return function(){return a.render(!0)}}(this)),a.off("ss-setTargetPosition").on("ss-setTargetPosition",function(a){return function(){return a.setTargetPosition()}}(this)),a.off("ss-destroy").on("ss-destroy",function(a){return function(){return a.destroy()}}(this))},c.prototype.setGlobals=function(){return this.globals.animated=this.options.animateOnInit},c.prototype.afterInit=function(){return this.globals.animated=this.options.animated},c.prototype.setIdentifier=function(){return this.identifier="shapeshifted_container_"+Math.random().toString(36).substring(7),this.$container.addClass(this.identifier)},c.prototype.enableFeatures=function(){return this.options.enableResize&&this.enableResize(),this.options.enableDrag||this.options.enableCrossDrop?this.enableDragNDrop():void 0},c.prototype.setActiveChildren=function(){var b,c,d,e,f,g,h,i,j,k,l,m;for(h=this.options,b=this.$container.children(h.selector),c=h.activeClass,i=b.length,f=j=0;i>=0?i>j:j>i;f=i>=0?++j:--j)a(b[f]).addClass(c);for(this.setParsedChildren(),e=h.columns,m=[],f=k=0,l=this.parsedChildren.length;l>=0?l>k:k>l;f=l>=0?++k:--k)d=this.parsedChildren[f].colspan,g=h.minColumns,d>e&&d>g?(h.minColumns=d,m.push(console.error("Shapeshift ERROR: There are child elements that have a larger colspan than the minimum columns set through options.\noptions.minColumns has been set to "+d))):m.push(void 0);return m},c.prototype.setParsedChildren=function(){var b,c,d,e,f,g,h;for(c=this.$container.find("."+this.options.activeClass).filter(":visible"),g=c.length,f=[],e=h=0;g>=0?g>h:h>g;e=g>=0?++h:--h)b=a(c[e]),d={i:e,el:b,colspan:parseInt(b.attr("data-ss-colspan"))||1,height:b.outerHeight()},f.push(d);return this.parsedChildren=f},c.prototype.gridInit=function(){var a,b,c,d,e;return d=this.options.gutterX,this.options.colWidth>=1?this.globals.col_width=this.options.colWidth+d:(c=this.parsedChildren[0],b=c.el.outerWidth(),a=c.colspan,e=(b-(a-1)*d)/a,this.globals.col_width=e+d)},c.prototype.render=function(a,b){return null==a&&(a=!1),this.setGridColumns(),this.arrange(a,b)},c.prototype.setGridColumns=function(){var a,b,c,d,e,f,g,h,i,j;switch(d=this.globals,i=this.options,b=d.col_width,f=i.gutterX,j=i.paddingX,g=this.$container.innerWidth()-2*j,h=i.minColumns,c=i.columns||Math.floor((g+f)/b),h&&h>c&&(c=h),d.columns=c,a=this.parsedChildren.length,c>a&&(c=a),d.child_offset=j,i.align){case"center":return e=c*b-f,d.child_offset+=(g-e)/2;case"right":return e=c*b-f,d.child_offset+=g-e}},c.prototype.arrange=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;for(a&&this.setParsedChildren(),k=this.globals,p=this.options,d=this.$container,h=this.getPositions(),q=this.parsedChildren,s=q.length,e=k.animated&&s<=p.animationThreshold,f=p.animationSpeed,j=p.draggedClass,l=t=0;s>=0?s>t:t>s;l=s>=0?++t:--t)c=q[l].el,g=h[l],m=c.hasClass(j),m&&(r=p.placeholderClass,c=c.siblings("."+r)),e&&!m?c.stop(!0,!1).animate(g,f,function(){}):c.css(g);return b&&(e?setTimeout(function(){return d.trigger("ss-drop-complete")},f):d.trigger("ss-drop-complete")),d.trigger("ss-arranged"),p.autoHeight?(i=k.container_height,n=p.maxHeight,o=p.minHeight,o&&o>i?i=o:n&&i>n&&(i=n),d.height(i)):void 0},c.prototype.getPositions=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;for(null==a&&(a=!0),f=this.globals,j=this.options,h=j.gutterY,k=j.paddingY,e=j.draggedClass,l=this.parsedChildren,q=l.length,b=[],i=r=0,s=f.columns;s>=0?s>r:r>s;i=s>=0?++r:--r)b.push(k);return o=function(){return function(a){var c,d,e,g,i,j,k;if(c=a.col,d=a.colspan,g=a.col*f.col_width+f.child_offset,i=b[c],m[a.i]={left:g,top:i},b[c]+=a.height+h,d>=1){for(k=[],e=j=1;d>=1?d>j:j>d;e=d>=1?++j:--j)k.push(b[c+e]=b[c]);return k}}}(this),c=function(a){return function(c){var d,e,f,g,h,i,j,k,l,m,n,o;for(l=b.length-c.colspan+1,k=b.slice(0).splice(0,l),d=void 0,j=n=0;l>=0?l>n:n>l;j=l>=0?++n:--n){for(e=a.lowestCol(k,j),f=c.colspan,g=b[e],h=!0,m=o=1;f>=1?f>o:o>f;m=f>=1?++o:--o)if(i=b[e+m],i>g){h=!1;break}if(h){d=e;break}}return d}}(this),p=[],n=function(){return function(){var a,b,d,e,f,g,h,i,j,k;for(f=[],e=g=0,i=p.length;i>=0?i>g:g>i;e=i>=0?++g:--g)d=p[e],d.col=c(d),d.col>=0&&(o(d),f.push(e));for(k=[],b=h=j=f.length-1;h>=0;b=h+=-1)a=f[b],k.push(p.splice(a,1));return k}}(this),m=[],(d=function(d){return function(){var f,g,h;for(h=[],i=g=0;q>=0?q>g:g>q;i=q>=0?++g:--g)f=l[i],a||!f.el.hasClass(e)?(f.col=f.colspan>1?c(f):d.lowestCol(b),void 0===f.col?p.push(f):o(f),h.push(n())):h.push(void 0);return h}}(this))(),j.autoHeight&&(g=b[this.highestCol(b)]-h,f.container_height=g+k),m},c.prototype.enableDragNDrop=function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;return o=this.options,d=this.$container,g=o.activeClass,m=o.draggedClass,q=o.placeholderClass,p=o.originalContainerClass,i=o.currentContainerClass,r=o.previousContainerClass,j=o.deleteClone,l=o.dragRate,k=o.dragClone,h=o.cloneClass,f=e=c=t=s=null,n=!1,o.enableDrag&&d.children("."+g).filter(o.dragWhitelist).draggable({addClasses:!1,containment:"document",handle:o.handle,zIndex:9999,start:function(b){var d;return f=a(b.target),k&&(c=f.clone(!0).insertBefore(f).addClass(h)),f.addClass(m),d=f.prop("tagName"),e=a("<"+d+" class='"+q+"' style='height: "+f.height()+"px; width: "+f.width()+"'></"+d+">"),f.parent().addClass(p).addClass(i),t=f.outerHeight()/2,s=f.outerWidth()/2},drag:function(){return function(c,d){return n||k&&j&&a("."+i)[0]===a("."+p)[0]||(e.remove().appendTo("."+i),a("."+i).trigger("ss-setTargetPosition"),n=!0,b.setTimeout(function(){return n=!1},l)),d.position.left=c.pageX-f.parent().offset().left-s,d.position.top=c.pageY-f.parent().offset().top-t}}(this),stop:function(){var b,d,g;return d=a("."+p),b=a("."+i),g=a("."+r),f.removeClass(m),a("."+q).remove(),k&&(j&&a("."+i)[0]===a("."+p)[0]?(c.remove(),a("."+i).trigger("ss-rearrange")):c.removeClass(h)),d[0]===b[0]?b.trigger("ss-rearranged",f):(d.trigger("ss-removed",f),b.trigger("ss-added",f)),d.trigger("ss-arrange").removeClass(p),b.trigger("ss-arrange",!0).removeClass(i),g.trigger("ss-arrange").removeClass(r),f=e=null}}),o.enableCrossDrop?d.droppable({accept:o.crossDropWhitelist,tolerance:"intersect",over:function(){return function(b){return a("."+r).removeClass(r),a("."+i).removeClass(i).addClass(r),a(b.target).addClass(i)}}(this),drop:function(b){return function(c,d){var e,g,h;return b.options.enableTrash?(g=a("."+p),e=a("."+i),h=a("."+r),f=a(d.helper),e.trigger("ss-trashed",f),f.remove(),g.trigger("ss-rearrange").removeClass(p),e.trigger("ss-rearrange").removeClass(i),h.trigger("ss-arrange").removeClass(r)):void 0}}(this)}):void 0},c.prototype.setTargetPosition=function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;if(k=this.options,k.enableTrash)return m=this.options.placeholderClass,a("."+m).remove();if(j=k.draggedClass,b=a("."+j),c=b.parent(),l=this.parsedChildren,f=this.getPositions(!1),t=f.length,p=b.offset().left-c.offset().left+this.globals.col_width/2,q=b.offset().top-c.offset().top+b.height()/2,r=9999999,s=0,t>1){for(h=k.cutoffStart+1||0,g=k.cutoffEnd||t,n=w=h;g>=h?g>w:w>g;n=g>=h?++w:--w)e=f[n],e&&(v=p-e.left,u=q-e.top,v>0&&u>0&&(i=Math.sqrt(u*u+v*v),r>i&&(r=i,s=n,n===t-1&&v>l[n].height/2&&s++)));s===l.length?(d=l[s-1].el,b.insertAfter(d)):(d=l[s].el,b.insertBefore(d))}else 1===t?(e=f[0],e.left<p?this.$container.append(b):this.$container.prepend(b)):this.$container.append(b);return this.arrange(!0),c[0]!==b.parent()[0]?(o=k.previousContainerClass,a("."+o).trigger("ss-rearrange")):void 0},c.prototype.enableResize=function(){var c,d,e;return c=this.options.animationSpeed,e=!1,d="resize."+this.identifier,a(b).on(d,function(a){return function(){return e?void 0:(e=!0,setTimeout(function(){return a.render()},c/3),setTimeout(function(){return a.render()},c/3),setTimeout(function(){return e=!1,a.render()},c/3))}}(this))},c.prototype.lowestCol=function(a,b){var c;return null==b&&(b=0),c=a.map(function(a,b){return[a,b]}),c.sort(function(a,b){var c;return c=a[0]-b[0],0===c&&(c=a[1]-b[1]),c}),c[b][1]},c.prototype.highestCol=function(c){return a.inArray(Math.max.apply(b,c),c)},c.prototype.destroy=function(){var a,b,c;return b=this.$container,b.off("ss-arrange"),b.off("ss-rearrange"),b.off("ss-setTargetPosition"),b.off("ss-destroy"),c=this.options.activeClass,a=b.find("."+c),this.options.enableDrag&&a.draggable("destroy"),this.options.enableCrossDrop&&b.droppable("destroy"),a.removeClass(c),b.removeClass(this.identifier)},c}(),a.fn[e]=function(d){return this.each(function(){var f,g,h;return g=null!=(h=a(this).attr("class").match(/shapeshifted_container_\w+/))?h[0]:void 0,g&&(f="resize."+g,a(b).off(f),a(this).removeClass(g)),a.data(this,"plugin_"+e,new c(this,d))})}}(jQuery,window,document),$(function(){var a,b,c,d,e,f;return a=$(".ss-container"),b=30,(e=function(){var c;return c=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,3,3],a.each(function(a){var d,e,f,g,h;for(e=[],g=h=0;b>=0?b>h:h>b;g=b>=0?++h:--h)0===a?(d=c[Math.floor(Math.random()*c.length)],f=80*d+12*(d-1)):(f=100*Math.random()+100,d=1),e.push("<li data-ss-colspan="+d+" style='height: "+f+"px'><div class='position'>"+g+"</div></li>");return $(this).append(e.join(""))})})(),d=function(){var a,b,c,d,e;for(c="ABCDEF".split(""),a="",b=d=0,e=c.length;e>=0?e>d:d>e;b=e>=0?++d:--d)a+=c[Math.round(5*Math.random())];return a},(f=function(c){return a.each(function(){var a,e,f,g,h,i,j,k;if(e=$(this).children().not(".credits"),b=e.length,"index"===c)return $(this).find(".position").show();for($(this).find(".position").hide(),k=[],h=j=0;b>=0?b>j:j>b;h=b>=0?++j:--j){switch(a=$(e[h]),g=a.height(),i=a.width(),c){case"fpoimg":f='url("http://fpoimg.com/'+i+"x"+g+"?bg_color="+d()+'&text_color=444444")';break;case"placekittens":f='url("http://www.placekitten.com/'+i+"/"+g+'")'}k.push(a.css({backgroundImage:f,height:g}))}return k})})("fpoimg"),c={minColumns:3},a.shapeshift(c),$(".options ul.animation li").on("click",function(){switch($(this).data("option")){case"enable":c.animated=!0;break;default:c.animated=!1}return a.shapeshift(c)}),$(".options ul.dragndrop li").on("click",function(){switch($(this).data("option")){case"enable":c.enableDrag=!0,c.enableDrop=!0;break;default:c.enableDrag=!1,c.enableDrop=!1}return a.trigger("ss-destroy"),a.shapeshift(c)}),$(".options ul.filtering li").on("click",function(){switch($(this).data("option")){case"hide":a.children(":visible").sort(function(){return Math.round(Math.random())-.5}).first().hide();break;default:a.children(":hidden").sort(function(){return Math.round(Math.random())-.5}).first().show()}return a.trigger("ss-rearrange")}),$(".options ul.placeholders li").on("click",function(){return f($(this).data("option")),a.shapeshift(c)}),a.on("ss-arranged",function(){var a;return a=$(this).find(".ss-dragging")[0]?1:0,$(this).children().each(function(){return $(this).find(".position").text($(this).index()-a)})}),a.on("ss-rearranged",function(a,b){return console.log("----------------------------------------"),console.log("This container:"),console.log($(this)),console.log("Has rearranged this item:"),console.log($(b)),console.log("Into this position:",$(b).index())}),a.on("ss-removed",function(a,b){return console.log("----------------------------------------"),console.log("This item:"),console.log($(b)),console.log("Has been removed from this container:"),console.log($(this))}),a.on("ss-added",function(a,b){return console.log("----------------------------------------"),console.log("This item:"),console.log($(b)),console.log("Has been added to this container:"),console.log($(this))}),a.on("ss-trashed",function(a,b){return console.log("----------------------------------------"),console.log("This item:"),console.log($(b)),console.log("Has been removed from the DOM")}),a.on("ss-drop-complete",function(){return console.log("----------------------------------------"),console.log("This container:"),console.log($(this)),console.log("Has finished rearrangement after a drop.")})});